# ============================================
# Go-GenAI-Stack 环境变量配置示例
# ============================================
# 
# 使用说明：
#   1. 复制此文件为 .env：cp env.example .env
#   2. 修改相应的值（特别是密码）
#   3. 后端会自动加载 docker/.env 文件（通过 godotenv）
#
# ⚠️  重要：Go 后端的环境变量必须以 APP_ 开头！
# 
# 配置加载方式：
#   - 后端使用 Go 原生标准库（os.Getenv）读取环境变量
#   - 零第三方配置管理依赖，完全透明
#   - 启动时集中加载并验证配置（config.Load()）
#   - 配置错误会导致启动失败（fail-fast 原则）
#
# 环境变量映射规则：
#   APP_DATABASE_HOST → Config.Database.Host
#   APP_SERVER_PORT   → Config.Server.Port
#   APP_REDIS_PASSWORD → Config.Redis.Password
#
# 默认值：
#   - 所有配置都有合理的默认值，无需设置环境变量也能运行
#   - 默认值定义在：backend/infrastructure/config/config.go 的 DefaultConfig() 函数
#   - 只需覆盖需要修改的配置即可
#
# 详细文档：
#   - 配置管理设计：docs/CONFIG_MANAGEMENT.md
#   - 配置加载代码：backend/infrastructure/config/loader.go
# ============================================

# ============================================
# Server 配置
# ============================================
# Go 后端服务器配置（使用 APP_ 前缀）
APP_SERVER_HOST=0.0.0.0
APP_SERVER_PORT=8080
APP_SERVER_READ_TIMEOUT=10s
APP_SERVER_WRITE_TIMEOUT=10s
APP_SERVER_IDLE_TIMEOUT=60s
APP_SERVER_MAX_BODY_SIZE=10485760

# ============================================
# Database 配置 (PostgreSQL)
# ============================================
# ⚠️  使用 APP_DATABASE_ 前缀（不是 DB_）
APP_DATABASE_HOST=localhost
APP_DATABASE_PORT=5432
APP_DATABASE_USER=genai
APP_DATABASE_PASSWORD=genai_password    # ⚠️ 生产环境务必修改
APP_DATABASE_DATABASE=go_genai_stack
APP_DATABASE_SSL_MODE=disable           # 本地开发用，生产环境改为 require

# 连接池配置
APP_DATABASE_MAX_OPEN_CONNS=25          # 最大打开连接数
APP_DATABASE_MAX_IDLE_CONNS=25          # 最大空闲连接数
APP_DATABASE_CONN_MAX_LIFETIME=1h      # 连接最大生命周期
APP_DATABASE_CONN_MAX_IDLE_TIME=10m    # 连接最大空闲时间

# ============================================
# Redis 配置
# ============================================
# ⚠️  使用 APP_REDIS_ 前缀（不是 REDIS_）
APP_REDIS_HOST=localhost
APP_REDIS_PORT=6379
APP_REDIS_PASSWORD=redis_password       # ⚠️ 生产环境务必修改
APP_REDIS_DB=0

# Redis 连接池
APP_REDIS_POOL_SIZE=10
APP_REDIS_MIN_IDLE_CONNS=5
APP_REDIS_MAX_RETRIES=3
APP_REDIS_DIAL_TIMEOUT=5s
APP_REDIS_READ_TIMEOUT=3s
APP_REDIS_WRITE_TIMEOUT=3s

# ============================================
# LLM 配置
# ============================================
# ⚠️  使用 APP_LLM_ 前缀
APP_LLM_DEFAULT_MODEL=gpt-4o
APP_LLM_DEFAULT_PROVIDER=openai
APP_LLM_TIMEOUT=30s
APP_LLM_MAX_RETRIES=3

# LLM Provider API Keys (可选)
# APP_LLM_PROVIDERS_OPENAI=sk-...
# APP_LLM_PROVIDERS_ANTHROPIC=...

# ============================================
# Logging 配置（结构化日志）
# ============================================
# ⚠️  使用 APP_LOGGING_ 前缀（不是 LOG_）
# 详细文档：backend/infrastructure/monitoring/logger/README.md

# 是否启用结构化日志（false 时使用标准 log）
APP_LOGGING_ENABLED=true

# 日志级别和格式
APP_LOGGING_LEVEL=info                  # debug, info, warn, error
APP_LOGGING_FORMAT=json                 # json（生产推荐）, console（开发推荐）
APP_LOGGING_OUTPUT=stdout               # stdout, stderr, file

# 文件输出配置（当 OUTPUT=file 时）
APP_LOGGING_OUTPUT_PATH=./logs/app.log
APP_LOGGING_MAX_SIZE=100                # 日志文件最大大小（MB）
APP_LOGGING_MAX_BACKUPS=3               # 保留的旧日志文件数量
APP_LOGGING_MAX_AGE=7                   # 保留旧日志文件的最大天数
APP_LOGGING_COMPRESS=true               # 是否压缩旧日志

# ============================================
# Monitoring 配置（可观测性）
# ============================================
# ⚠️  使用 APP_MONITORING_ 前缀
# 详细文档：backend/infrastructure/monitoring/README.md

# --- Metrics 配置（Prometheus）---
APP_MONITORING_METRICS_ENABLED=true     # 是否启用 Prometheus Metrics
APP_MONITORING_METRICS_PATH=/metrics    # Metrics 暴露路径
APP_MONITORING_METRICS_PORT=0           # Metrics 端口（0 表示与 Server.Port 相同）

# --- Tracing 配置（OpenTelemetry）---
# ⚠️  默认禁用，避免强依赖外部服务（符合 Starter 定位）
APP_MONITORING_TRACING_ENABLED=false    # 是否启用 OpenTelemetry Tracing
APP_MONITORING_TRACING_TYPE=otlp        # 导出器类型：otlp, jaeger, stdout
APP_MONITORING_TRACING_ENDPOINT=localhost:4317  # OTLP Exporter 端点
APP_MONITORING_SAMPLE_RATE=0.1          # 采样率 (0.0-1.0)，生产环境推荐 0.1

# --- Health Check 配置 ---
APP_MONITORING_HEALTH_ENABLED=true      # 是否启用健康检查端点
APP_MONITORING_HEALTH_PATH=/health      # 健康检查路径

# ============================================
# 可观测性使用场景
# ============================================
# 
# 场景 1：开发环境（推荐配置）
#   APP_LOGGING_ENABLED=true
#   APP_LOGGING_FORMAT=console           # 便于阅读
#   APP_MONITORING_METRICS_ENABLED=true
#   APP_MONITORING_TRACING_ENABLED=false # 避免依赖外部服务
#
# 场景 2：生产环境（完整可观测性）
#   APP_LOGGING_ENABLED=true
#   APP_LOGGING_FORMAT=json              # 结构化查询
#   APP_LOGGING_OUTPUT=file
#   APP_MONITORING_METRICS_ENABLED=true
#   APP_MONITORING_TRACING_ENABLED=true  # 启用分布式追踪
#   APP_MONITORING_SAMPLE_RATE=0.1       # 10% 采样
#
# 场景 3：最小化（只要 Metrics）
#   APP_LOGGING_ENABLED=false            # 使用标准 log
#   APP_MONITORING_METRICS_ENABLED=true
#   APP_MONITORING_TRACING_ENABLED=false
#
# 访问端点：
#   - Metrics: http://localhost:8080/metrics
#   - Health:  http://localhost:8080/health
#
# 快速启动指南：docs/Guides/observability-quickstart.md
# ============================================

# ============================================
# Docker Compose 专用配置
# ============================================
# 以下变量用于 docker-compose.yml，不需要 APP_ 前缀

# PostgreSQL 容器配置
POSTGRES_USER=genai
POSTGRES_PASSWORD=genai_password
POSTGRES_DB=go_genai_stack

# Redis 容器配置
REDIS_PASSWORD=redis_password

# pgAdmin (可选，数据库管理工具)
PGADMIN_PORT=5050
PGADMIN_EMAIL=admin@genai.local
PGADMIN_PASSWORD=admin_password

# Grafana (可选，可视化工具)
GRAFANA_USER=admin
GRAFANA_PASSWORD=admin

# ============================================
# 环境标识
# ============================================
APP_ENV=development

