# Task Management Domain Specification

**版本**: 1.0  
**创建日期**: 2025-12-19  
**状态**: ✅ 已实现  
**负责人**: Go-GenAI-Stack Team

---

## 1. 业务目标

### 1.1 问题陈述

用户需要一个简单、高效的任务管理系统来管理日常工作和个人待办事项。当前缺乏一个统一的平台来创建、跟踪和完成任务。

### 1.2 业务价值

- **提高生产力**：帮助用户组织和跟踪任务，减少遗漏
- **优先级管理**：通过优先级和截止日期帮助用户聚焦重要任务
- **状态追踪**：清晰的任务状态让用户了解工作进展

### 1.3 成功指标

- 用户能够快速创建任务（< 5 秒）
- 支持任务筛选和搜索（响应时间 < 100ms）
- 任务完成率提升 30%

---

## 2. 用户故事

### 2.1 核心用户故事

#### US-1: 创建任务
**作为** 用户  
**我希望** 能够创建新任务并设置标题、描述、优先级和截止日期  
**以便** 记录我需要完成的工作

**验收标准**：
- ✅ 用户可以输入任务标题（必填，1-200 字符）
- ✅ 用户可以输入任务描述（可选，最多 5000 字符）
- ✅ 用户可以设置优先级（low/medium/high，默认 medium）
- ✅ 用户可以设置截止日期（可选，ISO 8601 格式）
- ✅ 用户可以添加标签（最多 10 个，每个最多 50 字符）
- ✅ 创建成功后返回任务 ID 和基本信息

#### US-2: 查看任务列表
**作为** 用户  
**我希望** 能够查看我的任务列表并支持筛选和排序  
**以便** 快速找到需要处理的任务

**验收标准**：
- ✅ 显示任务列表，包含标题、状态、优先级、截止日期
- ✅ 支持按状态筛选（pending/in_progress/completed）
- ✅ 支持按优先级筛选（low/medium/high）
- ✅ 支持按标签筛选
- ✅ 支持按截止日期范围筛选
- ✅ 支持关键词搜索（标题/描述）
- ✅ 支持排序（创建时间、截止日期、优先级）
- ✅ 支持分页（默认 20 条/页，最多 100 条/页）

#### US-3: 更新任务
**作为** 用户  
**我希望** 能够更新任务信息  
**以便** 修改任务详情或调整优先级

**验收标准**：
- ✅ 用户可以更新任务标题、描述、优先级、截止日期、标签
- ✅ 已完成的任务不能更新
- ✅ 更新后返回最新任务信息

#### US-4: 完成任务
**作为** 用户  
**我希望** 能够将任务标记为已完成  
**以便** 跟踪任务完成情况

**验收标准**：
- ✅ 用户可以将任务状态改为 completed
- ✅ 自动记录完成时间
- ✅ 已完成的任务不能再次完成
- ✅ 已完成的任务不能更新

#### US-5: 删除任务
**作为** 用户  
**我希望** 能够删除不需要的任务  
**以便** 保持任务列表整洁

**验收标准**：
- ✅ 用户可以删除任务
- ✅ 删除后任务从列表中移除
- ✅ 删除操作不可恢复

#### US-6: 查看任务详情
**作为** 用户  
**我希望** 能够查看任务的完整信息  
**以便** 了解任务的所有细节

**验收标准**：
- ✅ 显示任务的所有字段（标题、描述、状态、优先级、截止日期、标签、时间戳）
- ✅ 任务不存在时返回 404 错误

---

## 3. 功能需求

### 3.1 任务实体

**任务（Task）** 是系统的核心实体，包含以下属性：

| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| `task_id` | string | ✅ | 唯一标识符（UUID） |
| `title` | string | ✅ | 任务标题（1-200 字符） |
| `description` | string | ❌ | 任务描述（最多 5000 字符） |
| `status` | enum | ✅ | 任务状态：pending/in_progress/completed |
| `priority` | enum | ❌ | 优先级：low/medium/high（默认 medium） |
| `due_date` | datetime | ❌ | 截止日期（ISO 8601） |
| `tags` | array<string> | ❌ | 标签列表（最多 10 个） |
| `created_at` | datetime | ✅ | 创建时间 |
| `updated_at` | datetime | ✅ | 更新时间 |
| `completed_at` | datetime | ❌ | 完成时间 |

### 3.2 API 端点

| 方法 | 路径 | 功能 | 认证 |
|------|------|------|------|
| `POST` | `/api/tasks` | 创建任务 | ❌ |
| `GET` | `/api/tasks` | 获取任务列表 | ❌ |
| `GET` | `/api/tasks/:id` | 获取任务详情 | ❌ |
| `PUT` | `/api/tasks/:id` | 更新任务 | ❌ |
| `POST` | `/api/tasks/:id/complete` | 完成任务 | ❌ |
| `DELETE` | `/api/tasks/:id` | 删除任务 | ❌ |

### 3.3 业务规则

#### BR-1: 任务创建规则
- 任务标题不能为空
- 任务标题长度必须在 1-200 字符之间
- 任务描述长度不能超过 5000 字符
- 优先级必须是 low、medium 或 high 之一
- 截止日期必须是有效的 ISO 8601 格式
- 标签数量不能超过 10 个
- 每个标签长度不能超过 50 字符

#### BR-2: 任务更新规则
- 已完成的任务不能更新
- 更新时所有字段验证规则与创建时相同
- 更新操作会自动更新 `updated_at` 字段

#### BR-3: 任务完成规则
- 只有 pending 或 in_progress 状态的任务可以完成
- 已完成的任务不能再次完成
- 完成操作会自动设置 `completed_at` 字段

#### BR-4: 任务删除规则
- 任何状态的任务都可以删除
- 删除操作不可恢复

---

## 4. 非功能需求

### 4.1 性能要求
- API 响应时间 < 200ms（P95）
- 支持并发请求 1000 QPS
- 数据库查询优化，使用索引

### 4.2 可用性要求
- 系统可用性 99.9%
- 错误率 < 0.1%

### 4.3 安全性要求
- 输入验证和 SQL 注入防护
- 请求限流（防止滥用）
- 错误信息不泄露敏感信息

### 4.4 可扩展性要求
- 支持水平扩展
- 数据库支持分库分表（未来）

---

## 5. 约束条件

### 5.1 技术约束
- 后端使用 Go + Hertz 框架
- 数据库使用 PostgreSQL
- 不使用 ORM，使用 database/sql
- 遵循 DDD 三层架构

### 5.2 业务约束
- 当前版本不支持用户认证（未来版本支持）
- 当前版本不支持任务分享（未来版本支持）

---

## 6. 依赖关系

### 6.1 外部依赖
- PostgreSQL 数据库
- Redis（可选，用于缓存）

### 6.2 内部依赖
- 无（Task 领域是独立领域）

---

## 7. 未来扩展

### 7.1 计划中的功能
- [ ] 用户认证和授权
- [ ] 任务分享和协作
- [ ] 任务评论
- [ ] 任务附件
- [ ] 周期性任务
- [ ] 子任务支持

### 7.2 可能的扩展
- [ ] 任务模板
- [ ] 任务统计和分析
- [ ] 任务提醒和通知
- [ ] 任务导出（CSV/JSON）

---

## 8. 验收标准

### 8.1 功能验收
- ✅ 所有用户故事都已实现
- ✅ 所有业务规则都已执行
- ✅ API 端点正常工作
- ✅ 错误处理正确

### 8.2 质量验收
- ✅ 单元测试覆盖率 > 80%
- ✅ 集成测试通过
- ✅ 代码通过 lint 检查
- ✅ 性能测试通过

---

## 9. 参考资料

- [Task Domain README](../../backend/domains/task/README.md)
- [Task Domain usecases.yaml](../../backend/domains/task/usecases.yaml)
- [Task Domain Glossary](../../backend/domains/task/glossary.md)
- [Task Domain Rules](../../backend/domains/task/rules.md)

