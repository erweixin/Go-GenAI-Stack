# Product Domain - Glossary (术语表)

本文档定义了商品领域中使用的所有术语和概念。

---

## 核心实体

### Product (商品)
积分商城中可供用户兑换的实体或虚拟物品。

**属性**：
- 商品名称、图片、描述
- 兑换所需金币数
- 库存信息
- 财务信息

**生命周期**：创建 → 下架 → 上架 → 兑换 → 售罄/下架

---

## 值对象

### ProductStatus (商品状态)
商品的当前状态。

**枚举值**：
- `OnShelf` (上架) - 商品在商城中展示，用户可以兑换
- `OffShelf` (下架) - 商品不在商城中展示，用户无法兑换

**业务规则**：
- 只有上架状态的商品才能被兑换
- 下架状态的商品不可见

### CoinType (金币类型)
兑换商品所需的金币类型。

**枚举值**：
- `Gold` (金币) - 主要货币
- `Silver` (银币) - 次要货币

**扩展性**：可添加更多货币类型（如积分、点券等）

---

## 库存相关术语

### Stock (总库存)
商品的总数量，包括已上架和未上架的部分。

**计算公式**：
```
总库存 = 已兑换数量 + 剩余库存
```

**约束**：
- 必须 ≥ 0
- 必须 ≥ 已兑换数量

### ListedQuantity (上架数量)
当前在商城中展示的商品数量。

**特点**：
- 可以小于等于总库存
- 可以分批上架

**业务规则**：
- 上架数量 ≤ 总库存
- 上架数量 ≥ 已兑换数量

### ListedLimit (上架限量)
单次上架的数量限制。

**用途**：
- 限量抢购活动
- 控制供应速度

**示例**：
- 总库存 1000，上架限量 100
- 每次只上架 100 个，售完再补货

### RedeemedCount (已兑换数量)
已被用户成功兑换的商品数量。

**特点**：
- 只增不减
- 用于统计销售数据

**计算公式**：
```
已兑换数量 = 所有成功兑换订单的数量总和
```

### AvailableQuantity (线上剩余)
当前可供用户兑换的数量。

**计算公式**：
```
线上剩余 = 上架数量 - 已兑换数量
```

**特点**：
- 实时计算
- 决定是否显示"售罄"

### SalesCount (销售数量)
商品的累计销售数量（等同于已兑换数量）。

**用途**：
- 数据统计
- 热门商品排行

---

## 财务相关术语

### InitialCoins (初始金币)
兑换该商品所需支付的金币数量。

**别名**：Price (价格), Points (积分)

**约束**：
- 必须 > 0
- 整数

### Cost (成本)
商品的采购或制作成本（人民币）。

**用途**：
- 成本核算
- 利润分析

**单位**：元（CNY）

### Revenue (已兑换收益)
已兑换商品产生的总收益。

**计算公式**：
```
已兑换收益 = 已兑换数量 × (初始金币 × 金币汇率)
```

**注意**：这里的收益是指金币价值折算，实际财务收益需结合金币获取成本。

---

## 限制相关术语

### PurchaseLimit (共购限制)
每个用户最多可兑换该商品的数量。

**用途**：
- 防止恶意囤货
- 公平分配稀缺商品

**示例**：
- 限购 2 件：每人最多兑换 2 个
- NULL：不限制

---

## 操作相关术语

### Shelve (上架)
将商品在商城中展示，使其可被用户兑换。

**前置条件**：
- 商品状态为下架
- 总库存 > 0

**后置条件**：
- 商品状态变为上架
- 设置上架数量

### Unshelve (下架)
将商品从商城中移除，用户无法兑换。

**用途**：
- 临时缺货
- 活动结束
- 商品维护

**后置条件**：
- 商品状态变为下架
- 已兑换订单不受影响

### DeductInventory (扣减库存)
用户兑换商品时，减少可用库存。

**触发时机**：
- 用户完成兑换支付
- 订单状态确认

**原子性**：
- 使用数据库行锁保证并发安全
- `SELECT ... FOR UPDATE`

---

## 元数据术语

### OperatorID (操作人)
执行商品操作的管理员或系统用户 ID。

**用途**：
- 操作审计
- 责任追溯

**关联**：
- 外键关联到 Users 表

---

## 业务流程术语

### Redemption Flow (兑换流程)
用户使用金币兑换商品的完整流程。

**步骤**：
1. 用户选择商品
2. 检查库存和金币余额
3. 扣减金币
4. 扣减库存
5. 生成兑换订单

**注意**：兑换流程不属于 Product Domain，由独立的 Redemption Domain 处理。

---

## 扩展术语

### Category (商品分类)
商品的分类标签（扩展功能）。

**示例**：
- 实物商品：玩具、书籍、电子产品
- 虚拟商品：会员、优惠券、礼品卡

### SKU (Stock Keeping Unit)
库存单位，用于区分同一商品的不同规格（扩展功能）。

**示例**：
- T恤 - 红色 - L码
- T恤 - 蓝色 - M码

---

## 术语对照表

| 中文 | 英文 | 别名 |
|-----|------|------|
| 商品 | Product | Item, Goods |
| 上架 | Shelve | Publish, List |
| 下架 | Unshelve | Delist, Remove |
| 库存 | Stock | Inventory |
| 兑换 | Redeem | Exchange, Purchase |
| 金币 | Coin | Point, Credit |
| 成本 | Cost | - |
| 收益 | Revenue | Earnings |
| 限购 | Purchase Limit | Quota |
| 操作人 | Operator | Admin, User |

---

**版本**：1.0  
**最后更新**：2025-12-01

